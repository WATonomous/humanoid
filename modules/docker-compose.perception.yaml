services:
  perception: # PYTHON
    build: &perception_build
      context: ..
      dockerfile: docker/perception/perception.Dockerfile
      cache_from:
        - "${SAMPLES_PRODUCER_IMAGE:?}:${TAG}"
        - "${SAMPLES_PRODUCER_IMAGE:?}:main"
    image: "${SAMPLES_PRODUCER_IMAGE:?}:${TAG}"
    profiles: [deploy]
    command: /bin/bash -c "ros2 launch perception_launch perception.launch.py"
    volumes:
      - ${MONO_DIR}/src/perception:/root/ament_ws/src/perception